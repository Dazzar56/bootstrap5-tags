function k(i){return i instanceof Element}function W(i,e){let t=e&&k(e)?e:document;return k(i)?i:t.querySelector(i)}function y(i,e){return W(i,e)}var Se="addEventListener",A=Se;var Le="removeEventListener",j=Le;var Ce=(()=>{let i=!1;try{let e=Object.defineProperty({},"passive",{get(){return i=!0,i}});document[A]("DOMContentLoaded",function t(){document[j]("DOMContentLoaded",t,e)},e)}catch(e){throw Error("Passive events are not supported")}return i})(),ce=Ce;var Ie=ce?{passive:!0}:!1,U=Ie;function w(i,e){i.classList.add(e)}function S(i,e){return i.classList.contains(e)}function p(i,e){i.classList.remove(e)}var xe="aria-expanded",K=xe;var Ae="show",m=Ae;var je="data-bs-toggle",_=je;var Ne=["dropdown","dropup","dropstart","dropend"],f=Ne;var Te="dropdown-menu",J=Te;function I(i,e){let t=new CustomEvent(i,{cancelable:!0});return e instanceof Object&&Object.keys(e).forEach(s=>{Object.defineProperty(t,s,{value:e[s]})}),t}function q(i){let e=i.closest("A");return i&&(i.hasAttribute("href")&&i.href.slice(-1)==="#"||e&&e.hasAttribute("href")&&e.href.slice(-1)==="#")}function N(i){i.focus()}function O(i){return i==="true"?!0:i==="false"?!1:Number.isNaN(+i)?i===""||i==="null"?null:i:+i}var De=i=>Object.keys(i),H=De;function Q(i,e,t,s){let o={...i.dataset},n={},l={};return H(o).forEach(r=>{let c=s&&r.includes(s)?r.replace(s,"").replace(/[A-Z]/,h=>h.toLowerCase()):r;l[c]=O(o[r])}),H(t).forEach(r=>{t[r]=O(t[r])}),H(e).forEach(r=>{r in t?n[r]=t[r]:r in l?n[r]=l[r]:n[r]=e[r]}),n}var V=class{constructor(e,t,s,o){let n=this,l=y(t);l[e]&&l[e].dispose(),n.element=l,s&&Object.keys(s).length&&(n.options=Q(l,s,o||{},"bs")),l[e]=n}dispose(e){let t=this;t.element[e]=null,Object.keys(t).forEach(s=>{t[s]=null})}};var[u]=f,g="Dropdown",Y=`[${_}="${u}"]`,T=f[1],B=f[2],F=f[3],L=`${J}-end`,de=["d-block","invisible"],ke=[u,T],he=[B,F],qe={offset:5,display:"dynamic"},Z=I(`show.bs.${u}`),ue=I(`shown.bs.${u}`),G=I(`hide.bs.${u}`),pe=I(`hidden.bs.${u}`);function X(i,e){let{element:t,menu:s,originalClass:o,menuEnd:n,options:l}=i,{offset:r}=l,c=t.parentElement;if(["margin","top","bottom","left","right"].forEach(d=>{s.style[d]=""}),p(c,"position-static"),!e){let d=S(s,L);c.className=o.join(" "),d&&!n?p(s,L):!d&&n&&w(s,L);return}let a=f.find(d=>o.includes(d))||u,C={dropdown:[r,0,0],dropup:[0,0,r],dropstart:[-1,r,0],dropend:[-1,0,0,r]},D={dropdown:{top:"100%"},dropup:{top:"auto",bottom:"100%"},dropstart:{left:"auto",right:"100%"},dropend:{left:"100%",right:"auto"},menuEnd:{right:0,left:"auto"}};de.forEach(d=>w(s,d));let be=new RegExp(`\\b(${u}|${T}|${B}|${F})+`),R={w:t.offsetWidth,h:t.offsetHeight},E={w:s.offsetWidth,h:s.offsetHeight},te=document.documentElement,se=document.body,ne=te.clientWidth||se.clientWidth,ie=te.clientHeight||se.clientHeight,b=t.getBoundingClientRect(),ye=b.left+R.w-E.w<0,oe=b.left-E.w<0,we=b.left+E.w>=ne,re=b.left+E.w+R.w>=ne,z=b.top+E.h>=ie,le=b.top+E.h+R.h>=ie,ae=b.top-E.h<0;he.includes(a)&&oe&&re&&(a=u),he.includes(a)&&z&&(a=T),a===B&&oe&&!z&&(a=F),a===F&&re&&!z&&(a=B),a===T&&ae&&!le&&(a=u),a===u&&le&&!ae&&(a=T),C=C[a],s.style.margin=`${C.map(d=>d&&`${d}px`).join(" ")}`,Object.keys(D[a]).forEach(d=>{s.style[d]=D[a][d]}),S(c,a)||(c.className=c.className.replace(be,a)),ke.includes(a)&&(!n&&we?w(s,L):n&&ye&&p(s,L),S(s,L)&&Object.keys(D.menuEnd).forEach(d=>{s.style[d]=D.menuEnd[d]})),de.forEach(d=>p(s,d))}function me(i){let e=i.open?A:j;document[e]("click",ge),document[e]("focus",ge),document[e]("keydown",He),document[e]("keyup",$e),i.options.display==="dynamic"&&(window[e]("scroll",ve,U),window[e]("resize",ve,U))}function fe(i,e){let t=e?A:j;i.element[t]("click",Oe)}function ee(){let i=f.concat("btn-group").map(e=>document.getElementsByClassName(`${e} ${m}`)).find(e=>e.length);return i&&i.length?Array.from(i[0].children).find(e=>e.hasAttribute(_)):null}function ge(i){let{target:e,type:t}=i;if(!e.closest)return;let s=ee(),o=s&&s.parentNode,n=s&&s[g],l=n&&n.menu,r=e.closest(Y)!==null,c=o&&o.contains(e)&&(e.tagName==="form"||e.closest("form")!==null);t==="click"&&q(e)&&i.preventDefault(),!(t==="focus"&&(e===s||e===l||l.contains(e)))&&(c||r||n&&n.hide(s))}function Oe(i){let e=this;e[g].toggle(e),q(i.target)&&i.preventDefault()}function He(i){(i.which===38||i.which===40)&&i.preventDefault()}function $e({which:i}){let e=ee(),t=e[g],{menu:s,menuItems:o,open:n}=t,l=document.activeElement,r=l===e,c=s.contains(l),h=l.parentNode===s||l.parentNode.parentNode===s,a=o.indexOf(l);h&&(r?a=0:i===38?a=a>1?a-1:0:i===40&&(a=a<o.length-1?a+1:a),o[a]&&N(o[a])),(o.length&&h||!o.length&&(c||r)||!c)&&n&&i===27&&t.toggle()}function ve(){let i=ee(),e=i&&i[g];e&&e.open&&X(e,1)}var P=class extends V{constructor(e,t){super(g,e,qe,t);let s=this,{element:o}=s,n=o.parentElement;s.menu=y(`.${J}`,n);let{menu:l}=s;s.originalClass=Array.from(n.classList),s.menuEnd=S(l,L),s.menuItems=[],Array.from(l.children).forEach(r=>{r.children.length&&r.children[0].tagName==="A"&&s.menuItems.push(r.children[0]),r.tagName==="A"&&s.menuItems.push(r)}),s.open=!1,fe(s,1)}toggle(e){let t=this,{open:s}=t;s?t.hide(e):t.show(e)}show(e){let t=this,s=y(f.concat("btn-group").map(h=>`.${h}.${m}`).join(",")),o=s&&y(Y,s);o&&o[g].hide();let{element:n,menu:l,open:r}=t,c=n.parentNode;Z.relatedTarget=e||null,c.dispatchEvent(Z),!Z.defaultPrevented&&(X(t,1),w(l,m),w(c,m),n.setAttribute(K,!0),t.open=!r,setTimeout(()=>{N(l.getElementsByTagName("INPUT")[0]||n),me(t),ue.relatedTarget=e||null,c.dispatchEvent(ue)},1))}hide(e){let t=this,{element:s,menu:o,open:n}=t,l=s.parentNode;G.relatedTarget=e||null,l.dispatchEvent(G),!G.defaultPrevented&&(p(o,m),p(l,m),X(t),s.setAttribute(K,!1),t.open=!n,N(s),setTimeout(()=>me(t),1),pe.relatedTarget=e||null,l.dispatchEvent(pe))}dispose(){let e=this,{element:t}=e;S(t.parentNode,m)&&e.open&&e.hide(),fe(e),super.dispose(g)}};P.init={component:g,selector:Y,constructor:P};var Ve="is-active",v=["is-active","bg-primary","text-white"],x="data-value",M=class{constructor(e,t={}){e.style.display="none",e.dataset.tags=!0,this.selectElement=e;let s=n=>["true","false","1","0",!0,!1].includes(n)&&!!JSON.parse(n),o={...t,...e.dataset};for(this.allowNew=o.allowNew?s(o.allowNew):!1,this.showAllSuggestions=o.showAllSuggestions?s(o.showAllSuggestions):!1,this.badgeStyle=o.badgeStyle||"primary",this.allowClear=o.allowClear?s(o.allowClear):!1,this.server=o.server||!1,this.liveServer=o.liveServer?s(o.liveServer):!1,this.suggestionsThreshold=o.suggestionsThreshold?parseInt(o.suggestionsThreshold):1,this.validationRegex=o.regex||"",this.separator=o.separator?o.separator.split("|"):[],this.max=o.max?parseInt(o.max):null,this.clearLabel=o.clearLabel||"Clear",this.searchLabel=o.searchLabel||"Type a value",this.placeholder=this.getPlaceholder(),this.keyboardNavigation=!1,this.parentForm=e.parentElement;this.parentForm&&(this.parentForm=this.parentForm.parentElement,this.parentForm.nodeName!="FORM"););if(this.parentForm.addEventListener("reset",n=>{this.reset()}),this.holderElement=document.createElement("div"),this.containerElement=document.createElement("div"),this.dropElement=document.createElement("ul"),this.searchInput=document.createElement("input"),this.holderElement.appendChild(this.containerElement),this.containerElement.appendChild(this.searchInput),this.holderElement.appendChild(this.dropElement),this.selectElement.parentNode.insertBefore(this.holderElement,this.selectElement.nextSibling),this.configureSearchInput(),this.configureHolderElement(),this.configureDropElement(),this.configureContainerElement(),this.server&&!this.liveServer)this.loadFromServer();else{let n=Array.from(this.selectElement.querySelectorAll("option")).map(l=>({value:l.getAttribute("value"),label:l.innerText}));this.buildSuggestions(n)}}static init(e="select[multiple]",t={}){let s=document.querySelectorAll(e);for(let o=0;o<s.length;o++)s[o].dataset.tags||new M(s[o],t)}loadFromServer(e=!1){this.abortController&&this.abortController.abort(),this.abortController=new AbortController,fetch(this.server+"?query="+encodeURIComponent(this.searchInput.value),{signal:this.abortController.signal}).then(t=>t.json()).then(t=>{let s=t.data||t;this.buildSuggestions(s),this.abortController=null,e&&this.showSuggestions()}).catch(t=>{t.name!=="AbortError"&&console.error(t)})}getPlaceholder(){let e=this.selectElement.querySelector("option");if(!!e){if(!e.value){let t=e.innerText;return e.remove(),t}return this.selectElement.getAttribute("placeholder")?this.selectElement.getAttribute("placeholder"):this.selectElement.getAttribute("data-placeholder")?this.selectElement.getAttribute("data-placeholder"):""}}configureDropElement(){this.dropElement.classList.add("dropdown-menu"),this.dropElement.classList.add("p-0"),this.dropElement.style.maxHeight="280px",this.dropElement.style.overflowY="auto",this.dropElement.addEventListener("mouseenter",e=>{this.keyboardNavigation=!1})}configureHolderElement(){this.holderElement.classList.add("form-control"),this.holderElement.classList.add("dropdown"),this.isDisabled()&&this.holderElement.setAttribute("readonly",""),this.getBootstrapVersion()===4&&(this.holderElement.style.height="auto")}configureContainerElement(){this.containerElement.addEventListener("click",t=>{this.isDisabled()||this.searchInput.focus()});let e=this.selectElement.querySelectorAll("option[selected]");for(let t=0;t<e.length;t++){let s=e[t];!s.value||(s.dataset.init=1,this.addItem(s.innerText,s.value))}}configureSearchInput(){let e=this;this.searchInput.type="text",this.searchInput.autocomplete="off",this.searchInput.style.backgroundColor="transparent",this.searchInput.style.border=0,this.searchInput.style.outline=0,this.searchInput.style.maxWidth="100%",this.searchInput.ariaLabel=this.searchLabel,this.isDisabled()&&this.searchInput.setAttribute("disabled",""),this.adjustWidth(),this.searchInput.addEventListener("input",t=>{this.adjustWidth(),this.searchInput.value.length>=this.suggestionsThreshold?this.liveServer?this.loadFromServer(!0):this.showSuggestions():this.hideSuggestions()}),this.searchInput.addEventListener("focus",t=>{this.searchInput.value.length>=this.suggestionsThreshold&&this.showSuggestions()}),this.searchInput.addEventListener("focusout",t=>{e.hideSuggestions()}),this.searchInput.addEventListener("keydown",t=>{let s=t.keyCode||t.key;if(this.separator.length&&this.separator.includes(t.key)){t.preventDefault(),this.addItem(this.searchInput.value,null)&&this.resetSearchInput();return}switch(s){case 13:case"Enter":let o=this.getActiveSelection();o?o.click():this.allowNew&&!this.isSelected(this.searchInput.value)&&this.searchInput.value&&this.addItem(this.searchInput.value,null)&&this.resetSearchInput(),t.preventDefault();break;case 38:case"ArrowUp":t.preventDefault(),this.keyboardNavigation=!0;let n=this.moveSelectionUp();this.searchInput.value.length==0&&this.dropElement.classList.contains("show")&&!n&&this.hideSuggestions();break;case 40:case"ArrowDown":t.preventDefault(),this.keyboardNavigation=!0,this.moveSelectionDown(),this.searchInput.value.length==0&&!this.dropElement.classList.contains("show")&&this.showSuggestions();break;case 8:case"Backspace":this.searchInput.value.length==0&&(this.removeLastItem(),this.adjustWidth(),this.hideSuggestions());break}})}moveSelectionUp(){let e=this.getActiveSelection();if(e){let t=e.parentNode;do t=t.previousSibling;while(t&&t.style.display=="none");return t?(e.classList.remove(...v),t.querySelector("a").classList.add(...v),t.parentNode.scrollTop=t.offsetTop-t.parentNode.offsetTop,t):null}return null}moveSelectionDown(){let e=this.getActiveSelection(),t=null;if(e){t=e.parentNode;do t=t.nextSibling;while(t&&t.style.display=="none");return t?(e.classList.remove(...v),t.querySelector("a").classList.add(...v),t.offsetTop>t.parentNode.offsetHeight-t.offsetHeight&&(t.parentNode.scrollTop+=t.offsetHeight),t):null}return t}adjustWidth(){this.searchInput.value?this.searchInput.size=this.searchInput.value.length+1:this.getSelectedValues().length?(this.searchInput.placeholder="",this.searchInput.size=1):(this.searchInput.size=this.placeholder.length,this.searchInput.placeholder=this.placeholder)}buildSuggestions(e=null){for(;this.dropElement.lastChild;)this.dropElement.removeChild(this.dropElement.lastChild);for(let t=0;t<e.length;t++){let s=e[t];if(!s.value)continue;let o=document.createElement("li"),n=document.createElement("a");if(o.append(n),n.classList.add("dropdown-item"),n.setAttribute(x,s.value),n.setAttribute("href","#"),n.innerText=s.label,s.data)for(let[l,r]of Object.entries(s.data))n.dataset[l]=r;this.dropElement.appendChild(o),n.addEventListener("mouseenter",l=>{this.keyboardNavigation||(this.removeActiveSelection(),o.querySelector("a").classList.add(...v))}),n.addEventListener("mousemove",l=>{this.keyboardNavigation=!1}),n.addEventListener("mousedown",l=>{l.preventDefault()}),n.addEventListener("click",l=>{l.preventDefault(),this.addItem(n.innerText,n.getAttribute(x),n.dataset),this.resetSearchInput()})}}reset(){this.removeAll();let e=this.selectElement.querySelectorAll("option[data-init]");for(let t=0;t<e.length;t++){let s=e[t];this.addItem(s.innerText,s.value)}this.adjustWidth()}resetSearchInput(){this.searchInput.value="",this.adjustWidth(),this.hideSuggestions(),this.max&&this.getSelectedValues().length===this.max?this.searchInput.style.visibility="hidden":this.searchInput.style.visibility=="hidden"&&(this.searchInput.style.visibility="visible")}getSelectedValues(){let e=this.selectElement.querySelectorAll("option:checked");return Array.from(e).map(t=>t.value)}showSuggestions(){this.dropElement.classList.contains("show")||this.dropElement.classList.add("show"),this.dropElement.style.left=this.searchInput.offsetLeft+"px";let e=this.searchInput.value.toLocaleLowerCase(),t=this.getSelectedValues(),s=this.dropElement.querySelectorAll("li"),o=!1,n=null,l=!1;for(let r=0;r<s.length;r++){let c=s[r],h=c.innerText.toLocaleLowerCase(),a=c.querySelector("a");if(a.classList.remove(...v),t.indexOf(a.getAttribute(x))!=-1){c.style.display="none";continue}l=!0;let C=e.length===0||h.indexOf(e)!==-1;this.showAllSuggestions||this.suggestionsThreshold===0||C?(c.style.display="list-item",o=!0,!n&&C&&(n=c)):c.style.display="none"}o||this.dropElement.classList.remove("show"),n?(this.holderElement.classList.contains("is-invalid")&&this.holderElement.classList.remove("is-invalid"),n.querySelector("a").classList.add(...v),n.parentNode.scrollTop=n.offsetTop-n.parentNode.offsetTop):!this.allowNew&&!(e.length===0&&!l)?this.holderElement.classList.add("is-invalid"):this.validationRegex&&this.holderElement.classList.contains("is-invalid")&&this.holderElement.classList.remove("is-invalid")}hideSuggestions(){this.dropElement.classList.contains("show")&&this.dropElement.classList.remove("show"),this.holderElement.classList.contains("is-invalid")&&this.holderElement.classList.remove("is-invalid")}getActiveSelection(){return this.dropElement.querySelector("a."+Ve)}removeActiveSelection(){let e=this.getActiveSelection();e&&e.classList.remove(...v)}removeAll(){this.containerElement.querySelectorAll("span").forEach(t=>{this.removeLastItem()})}removeLastItem(){let e=this.containerElement.querySelectorAll("span");if(!e.length)return;let t=e[e.length-1];this.removeItem(t.getAttribute(x))}getBootstrapVersion(){let e=5;return window.jQuery&&$.fn.tooltip!=null&&$.fn.tooltip.Constructor!=null&&(e=parseInt($.fn.tooltip.Constructor.VERSION.charAt(0))),e}isSelected(e){let t=Array.from(this.selectElement.querySelectorAll("option")).find(s=>s.textContent==e);return!!(t&&t.getAttribute("selected"))}isDisabled(){return this.selectElement.hasAttribute("disabled")||this.selectElement.hasAttribute("readonly")}validateRegex(e){return new RegExp(this.validationRegex.trim()).test(e)}addItem(e,t=null,s={}){if(t||(t=e),this.validationRegex&&!this.validateRegex(e))return this.holderElement.classList.add("is-invalid"),!1;let o=this.getBootstrapVersion(),n=this.selectElement.querySelector('option[value="'+t+'"]');n&&(s=n.dataset);let l=e,r=document.createElement("span"),c=this.badgeStyle;if(r.classList.add("badge"),s.badgeStyle&&(c=s.badgeStyle),s.badgeClass&&r.classList.add(s.badgeClass),o===5?(r.classList.add("bg-"+c),r.classList.add("me-2")):(r.classList.add("badge-"+c),r.classList.add("mr-2")),r.setAttribute(x,t),this.allowClear&&!this.isDisabled()&&(l=(o===5?'<button type="button" style="font-size:0.65em" class="me-2 btn-close btn-close-white" aria-label="'+this.clearLabel+'"></button>':'<button type="button" style="font-size:1em;float:left;text-shadow:none;color:currentColor;" class="mr-2 close" aria-label="'+this.clearLabel+'"><span aria-hidden="true">&times;</span></button>')+l),r.innerHTML=l,this.containerElement.insertBefore(r,this.searchInput),this.allowClear&&!this.isDisabled()&&r.querySelector("button").addEventListener("click",h=>{h.preventDefault(),h.stopPropagation(),this.removeItem(t),document.activeElement.blur()}),n)n.setAttribute("selected","selected");else{n=document.createElement("option"),n.value=t,n.innerText=e;for(let[h,a]of Object.entries(s))n.dataset[h]=a;n.setAttribute("selected","selected"),this.selectElement.appendChild(n)}return!0}removeItem(e){let t=this.containerElement.querySelector("span["+x+'="'+e+'"]');if(!t)return;t.remove();let s=this.selectElement.querySelector('option[value="'+e+'"]');s&&s.removeAttribute("selected"),this.searchInput.style.visibility=="hidden"&&this.max&&this.getSelectedValues().length<this.max&&(this.searchInput.style.visibility="visible")}},Ee=M;var $t=Ee;export{$t as default};
//# sourceMappingURL=tags-standalone.min.js.map
