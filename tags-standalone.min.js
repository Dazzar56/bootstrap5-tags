function k(n){return n instanceof Element}function W(n,e){let t=e&&k(e)?e:document;return k(n)?n:t.querySelector(n)}function y(n,e){return W(n,e)}var Se="addEventListener",A=Se;var Le="removeEventListener",j=Le;var Ce=(()=>{let n=!1;try{let e=Object.defineProperty({},"passive",{get(){return n=!0,n}});document[A]("DOMContentLoaded",function t(){document[j]("DOMContentLoaded",t,e)},e)}catch(e){throw Error("Passive events are not supported")}return n})(),de=Ce;var Ie=de?{passive:!0}:!1,U=Ie;function w(n,e){n.classList.add(e)}function S(n,e){return n.classList.contains(e)}function p(n,e){n.classList.remove(e)}var xe="aria-expanded",K=xe;var Ae="show",m=Ae;var je="data-bs-toggle",_=je;var Ne=["dropdown","dropup","dropstart","dropend"],f=Ne;var Te="dropdown-menu",Q=Te;function I(n,e){let t=new CustomEvent(n,{cancelable:!0});return e instanceof Object&&Object.keys(e).forEach(s=>{Object.defineProperty(t,s,{value:e[s]})}),t}function q(n){let e=n.closest("A");return n&&(n.hasAttribute("href")&&n.href.slice(-1)==="#"||e&&e.hasAttribute("href")&&e.href.slice(-1)==="#")}function N(n){n.focus()}function O(n){return n==="true"?!0:n==="false"?!1:Number.isNaN(+n)?n===""||n==="null"?null:n:+n}var De=n=>Object.keys(n),H=De;function Y(n,e,t,s){let r={...n.dataset},i={},l={};return H(r).forEach(o=>{let d=s&&o.includes(s)?o.replace(s,"").replace(/[A-Z]/,h=>h.toLowerCase()):o;l[d]=O(r[o])}),H(t).forEach(o=>{t[o]=O(t[o])}),H(e).forEach(o=>{o in t?i[o]=t[o]:o in l?i[o]=l[o]:i[o]=e[o]}),i}var V=class{constructor(e,t,s,r){let i=this,l=y(t);l[e]&&l[e].dispose(),i.element=l,s&&Object.keys(s).length&&(i.options=Y(l,s,r||{},"bs")),l[e]=i}dispose(e){let t=this;t.element[e]=null,Object.keys(t).forEach(s=>{t[s]=null})}};var[u]=f,g="Dropdown",Z=`[${_}="${u}"]`,T=f[1],F=f[2],P=f[3],L=`${Q}-end`,ce=["d-block","invisible"],ke=[u,T],he=[F,P],qe={offset:5,display:"dynamic"},G=I(`show.bs.${u}`),ue=I(`shown.bs.${u}`),J=I(`hide.bs.${u}`),pe=I(`hidden.bs.${u}`);function X(n,e){let{element:t,menu:s,originalClass:r,menuEnd:i,options:l}=n,{offset:o}=l,d=t.parentElement;if(["margin","top","bottom","left","right"].forEach(c=>{s.style[c]=""}),p(d,"position-static"),!e){let c=S(s,L);d.className=r.join(" "),c&&!i?p(s,L):!c&&i&&w(s,L);return}let a=f.find(c=>r.includes(c))||u,C={dropdown:[o,0,0],dropup:[0,0,o],dropstart:[-1,o,0],dropend:[-1,0,0,o]},D={dropdown:{top:"100%"},dropup:{top:"auto",bottom:"100%"},dropstart:{left:"auto",right:"100%"},dropend:{left:"100%",right:"auto"},menuEnd:{right:0,left:"auto"}};ce.forEach(c=>w(s,c));let be=new RegExp(`\\b(${u}|${T}|${F}|${P})+`),R={w:t.offsetWidth,h:t.offsetHeight},E={w:s.offsetWidth,h:s.offsetHeight},te=document.documentElement,se=document.body,ne=te.clientWidth||se.clientWidth,ie=te.clientHeight||se.clientHeight,b=t.getBoundingClientRect(),ye=b.left+R.w-E.w<0,oe=b.left-E.w<0,we=b.left+E.w>=ne,re=b.left+E.w+R.w>=ne,z=b.top+E.h>=ie,le=b.top+E.h+R.h>=ie,ae=b.top-E.h<0;he.includes(a)&&oe&&re&&(a=u),he.includes(a)&&z&&(a=T),a===F&&oe&&!z&&(a=P),a===P&&re&&!z&&(a=F),a===T&&ae&&!le&&(a=u),a===u&&le&&!ae&&(a=T),C=C[a],s.style.margin=`${C.map(c=>c&&`${c}px`).join(" ")}`,Object.keys(D[a]).forEach(c=>{s.style[c]=D[a][c]}),S(d,a)||(d.className=d.className.replace(be,a)),ke.includes(a)&&(!i&&we?w(s,L):i&&ye&&p(s,L),S(s,L)&&Object.keys(D.menuEnd).forEach(c=>{s.style[c]=D.menuEnd[c]})),ce.forEach(c=>p(s,c))}function me(n){let e=n.open?A:j;document[e]("click",ge),document[e]("focus",ge),document[e]("keydown",He),document[e]("keyup",$e),n.options.display==="dynamic"&&(window[e]("scroll",ve,U),window[e]("resize",ve,U))}function fe(n,e){let t=e?A:j;n.element[t]("click",Oe)}function ee(){let n=f.concat("btn-group").map(e=>document.getElementsByClassName(`${e} ${m}`)).find(e=>e.length);return n&&n.length?Array.from(n[0].children).find(e=>e.hasAttribute(_)):null}function ge(n){let{target:e,type:t}=n;if(!e.closest)return;let s=ee(),r=s&&s.parentNode,i=s&&s[g],l=i&&i.menu,o=e.closest(Z)!==null,d=r&&r.contains(e)&&(e.tagName==="form"||e.closest("form")!==null);t==="click"&&q(e)&&n.preventDefault(),!(t==="focus"&&(e===s||e===l||l.contains(e)))&&(d||o||i&&i.hide(s))}function Oe(n){let e=this;e[g].toggle(e),q(n.target)&&n.preventDefault()}function He(n){(n.which===38||n.which===40)&&n.preventDefault()}function $e({which:n}){let e=ee(),t=e[g],{menu:s,menuItems:r,open:i}=t,l=document.activeElement,o=l===e,d=s.contains(l),h=l.parentNode===s||l.parentNode.parentNode===s,a=r.indexOf(l);h&&(o?a=0:n===38?a=a>1?a-1:0:n===40&&(a=a<r.length-1?a+1:a),r[a]&&N(r[a])),(r.length&&h||!r.length&&(d||o)||!d)&&i&&n===27&&t.toggle()}function ve(){let n=ee(),e=n&&n[g];e&&e.open&&X(e,1)}var B=class extends V{constructor(e,t){super(g,e,qe,t);let s=this,{element:r}=s,i=r.parentElement;s.menu=y(`.${Q}`,i);let{menu:l}=s;s.originalClass=Array.from(i.classList),s.menuEnd=S(l,L),s.menuItems=[],Array.from(l.children).forEach(o=>{o.children.length&&o.children[0].tagName==="A"&&s.menuItems.push(o.children[0]),o.tagName==="A"&&s.menuItems.push(o)}),s.open=!1,fe(s,1)}toggle(e){let t=this,{open:s}=t;s?t.hide(e):t.show(e)}show(e){let t=this,s=y(f.concat("btn-group").map(h=>`.${h}.${m}`).join(",")),r=s&&y(Z,s);r&&r[g].hide();let{element:i,menu:l,open:o}=t,d=i.parentNode;G.relatedTarget=e||null,d.dispatchEvent(G),!G.defaultPrevented&&(X(t,1),w(l,m),w(d,m),i.setAttribute(K,!0),t.open=!o,setTimeout(()=>{N(l.getElementsByTagName("INPUT")[0]||i),me(t),ue.relatedTarget=e||null,d.dispatchEvent(ue)},1))}hide(e){let t=this,{element:s,menu:r,open:i}=t,l=s.parentNode;J.relatedTarget=e||null,l.dispatchEvent(J),!J.defaultPrevented&&(p(r,m),p(l,m),X(t),s.setAttribute(K,!1),t.open=!i,N(s),setTimeout(()=>me(t),1),pe.relatedTarget=e||null,l.dispatchEvent(pe))}dispose(){let e=this,{element:t}=e;S(t.parentNode,m)&&e.open&&e.hide(),fe(e),super.dispose(g)}};B.init={component:g,selector:Z,constructor:B};var Ve="is-active",v=["is-active","bg-primary","text-white"],x="data-value",M=class{constructor(e,t={}){for(this.selectElement=e,this.selectElement.style.display="none",this.selectElement.dataset.tags=!0,this.placeholder=this.getPlaceholder(),this.allowNew=!!e.dataset.allowNew,this.showAllSuggestions=!!e.dataset.showAllSuggestions,this.badgeStyle=e.dataset.badgeStyle||"primary",this.allowClear=!!e.dataset.allowClear,this.server=e.dataset.server||!1,this.liveServer=!!e.dataset.liveServer,this.suggestionsThreshold=e.dataset.suggestionsThreshold?parseInt(e.dataset.suggestionsThreshold):1,this.validationRegex=e.dataset.regex||"",this.separator=e.dataset.separator?e.dataset.separator.split("|"):[],this.max=e.dataset.max?parseInt(e.dataset.max):null,this.keyboardNavigation=!1,this.clearLabel=t.clearLabel||"Clear",this.searchLabel=t.searchLabel||"Type a value",this.parentForm=e.parentElement;this.parentForm&&(this.parentForm=this.parentForm.parentElement,this.parentForm.nodeName!="FORM"););if(this.parentForm.addEventListener("reset",s=>{this.reset()}),this.holderElement=document.createElement("div"),this.containerElement=document.createElement("div"),this.dropElement=document.createElement("ul"),this.searchInput=document.createElement("input"),this.holderElement.appendChild(this.containerElement),this.containerElement.appendChild(this.searchInput),this.holderElement.appendChild(this.dropElement),this.selectElement.parentNode.insertBefore(this.holderElement,this.selectElement.nextSibling),this.configureSearchInput(),this.configureHolderElement(),this.configureDropElement(),this.configureContainerElement(),this.server&&!this.liveServer)this.loadFromServer();else{let s=Array.from(this.selectElement.querySelectorAll("option")).map(r=>({value:r.getAttribute("value"),label:r.innerText}));this.buildSuggestions(s)}}static init(e="select[multiple]",t={}){let s=document.querySelectorAll(e);for(let r=0;r<s.length;r++)s[r].dataset.tags||new M(s[r],t)}loadFromServer(e=!1){this.abortController&&this.abortController.abort(),this.abortController=new AbortController,fetch(this.server+"?query="+encodeURIComponent(this.searchInput.value),{signal:this.abortController.signal}).then(t=>t.json()).then(t=>{let s=t.data||t;this.buildSuggestions(s),this.abortController=null,e&&this.showSuggestions()}).catch(t=>{t.name!=="AbortError"&&console.error(t)})}getPlaceholder(){let e=this.selectElement.querySelector("option");if(!!e){if(!e.value){let t=e.innerText;return e.remove(),t}return this.selectElement.getAttribute("placeholder")?this.selectElement.getAttribute("placeholder"):this.selectElement.getAttribute("data-placeholder")?this.selectElement.getAttribute("data-placeholder"):""}}configureDropElement(){this.dropElement.classList.add("dropdown-menu"),this.dropElement.classList.add("p-0"),this.dropElement.style.maxHeight="280px",this.dropElement.style.overflowY="auto",this.dropElement.addEventListener("mouseenter",e=>{this.keyboardNavigation=!1})}configureHolderElement(){this.holderElement.classList.add("form-control"),this.holderElement.classList.add("dropdown"),this.isDisabled()&&this.holderElement.setAttribute("readonly",""),this.getBootstrapVersion()===4&&(this.holderElement.style.height="auto")}configureContainerElement(){this.containerElement.addEventListener("click",t=>{this.isDisabled()||this.searchInput.focus()});let e=this.selectElement.querySelectorAll("option[selected]");for(let t=0;t<e.length;t++){let s=e[t];!s.value||(s.dataset.init=1,this.addItem(s.innerText,s.value))}}configureSearchInput(){let e=this;this.searchInput.type="text",this.searchInput.autocomplete="off",this.searchInput.style.backgroundColor="transparent",this.searchInput.style.border=0,this.searchInput.style.outline=0,this.searchInput.style.maxWidth="100%",this.searchInput.ariaLabel=this.searchLabel,this.isDisabled()&&this.searchInput.setAttribute("disabled",""),this.adjustWidth(),this.searchInput.addEventListener("input",t=>{this.adjustWidth(),this.searchInput.value.length>=this.suggestionsThreshold?this.liveServer?this.loadFromServer(!0):this.showSuggestions():this.hideSuggestions()}),this.searchInput.addEventListener("focus",t=>{this.searchInput.value.length>=this.suggestionsThreshold&&this.showSuggestions()}),this.searchInput.addEventListener("focusout",t=>{e.hideSuggestions()}),this.searchInput.addEventListener("keydown",t=>{let s=t.keyCode||t.key;if(this.separator.length&&this.separator.includes(t.key)){t.preventDefault(),this.addItem(this.searchInput.value,null)&&this.resetSearchInput();return}switch(s){case 13:case"Enter":let r=this.getActiveSelection();r?r.click():this.allowNew&&!this.isSelected(this.searchInput.value)&&this.searchInput.value&&this.addItem(this.searchInput.value,null)&&this.resetSearchInput(),t.preventDefault();break;case 38:case"ArrowUp":t.preventDefault(),this.keyboardNavigation=!0;let i=this.moveSelectionUp();this.searchInput.value.length==0&&this.dropElement.classList.contains("show")&&!i&&this.hideSuggestions();break;case 40:case"ArrowDown":t.preventDefault(),this.keyboardNavigation=!0,this.moveSelectionDown(),this.searchInput.value.length==0&&!this.dropElement.classList.contains("show")&&this.showSuggestions();break;case 8:case"Backspace":this.searchInput.value.length==0&&(this.removeLastItem(),this.adjustWidth(),this.hideSuggestions());break}})}moveSelectionUp(){let e=this.getActiveSelection();if(e){let t=e.parentNode;do t=t.previousSibling;while(t&&t.style.display=="none");return t?(e.classList.remove(...v),t.querySelector("a").classList.add(...v),t.parentNode.scrollTop=t.offsetTop-t.parentNode.offsetTop,t):null}return null}moveSelectionDown(){let e=this.getActiveSelection(),t=null;if(e){t=e.parentNode;do t=t.nextSibling;while(t&&t.style.display=="none");return t?(e.classList.remove(...v),t.querySelector("a").classList.add(...v),t.offsetTop>t.parentNode.offsetHeight-t.offsetHeight&&(t.parentNode.scrollTop+=t.offsetHeight),t):null}return t}adjustWidth(){this.searchInput.value?this.searchInput.size=this.searchInput.value.length+1:this.getSelectedValues().length?(this.searchInput.placeholder="",this.searchInput.size=1):(this.searchInput.size=this.placeholder.length,this.searchInput.placeholder=this.placeholder)}buildSuggestions(e=null){for(;this.dropElement.lastChild;)this.dropElement.removeChild(this.dropElement.lastChild);for(let t=0;t<e.length;t++){let s=e[t];if(!s.value)continue;let r=document.createElement("li"),i=document.createElement("a");if(r.append(i),i.classList.add("dropdown-item"),i.setAttribute(x,s.value),i.setAttribute("href","#"),i.innerText=s.label,s.data)for(let[l,o]of Object.entries(s.data))i.dataset[l]=o;this.dropElement.appendChild(r),i.addEventListener("mouseenter",l=>{this.keyboardNavigation||(this.removeActiveSelection(),r.querySelector("a").classList.add(...v))}),i.addEventListener("mousemove",l=>{this.keyboardNavigation=!1}),i.addEventListener("mousedown",l=>{l.preventDefault()}),i.addEventListener("click",l=>{l.preventDefault(),this.addItem(i.innerText,i.getAttribute(x),i.dataset),this.resetSearchInput()})}}reset(){this.removeAll();let e=this.selectElement.querySelectorAll("option[data-init]");for(let t=0;t<e.length;t++){let s=e[t];this.addItem(s.innerText,s.value)}}resetSearchInput(){this.searchInput.value="",this.adjustWidth(),this.hideSuggestions(),this.max&&this.getSelectedValues().length===this.max?this.searchInput.style.visibility="hidden":this.searchInput.style.visibility=="hidden"&&(this.searchInput.style.visibility="visible")}getSelectedValues(){let e=this.selectElement.querySelectorAll("option:checked");return Array.from(e).map(t=>t.value)}showSuggestions(){this.dropElement.classList.contains("show")||this.dropElement.classList.add("show"),this.dropElement.style.left=this.searchInput.offsetLeft+"px";let e=this.searchInput.value.toLocaleLowerCase(),t=this.getSelectedValues(),s=this.dropElement.querySelectorAll("li"),r=!1,i=null,l=!1;for(let o=0;o<s.length;o++){let d=s[o],h=d.innerText.toLocaleLowerCase(),a=d.querySelector("a");if(a.classList.remove(...v),t.indexOf(a.getAttribute(x))!=-1){d.style.display="none";continue}l=!0;let C=e.length===0||h.indexOf(e)!==-1;this.showAllSuggestions||this.suggestionsThreshold===0||C?(d.style.display="list-item",r=!0,!i&&C&&(i=d)):d.style.display="none"}r||this.dropElement.classList.remove("show"),i?(this.holderElement.classList.contains("is-invalid")&&this.holderElement.classList.remove("is-invalid"),i.querySelector("a").classList.add(...v),i.parentNode.scrollTop=i.offsetTop-i.parentNode.offsetTop):!this.allowNew&&!(e.length===0&&!l)?this.holderElement.classList.add("is-invalid"):this.validationRegex&&this.holderElement.classList.contains("is-invalid")&&this.holderElement.classList.remove("is-invalid")}hideSuggestions(){this.dropElement.classList.contains("show")&&this.dropElement.classList.remove("show"),this.holderElement.classList.contains("is-invalid")&&this.holderElement.classList.remove("is-invalid")}getActiveSelection(){return this.dropElement.querySelector("a."+Ve)}removeActiveSelection(){let e=this.getActiveSelection();e&&e.classList.remove(...v)}removeAll(){this.containerElement.querySelectorAll("span").forEach(t=>{this.removeLastItem()})}removeLastItem(){let e=this.containerElement.querySelectorAll("span");if(!e.length)return;let t=e[e.length-1];this.removeItem(t.getAttribute(x))}getBootstrapVersion(){let e=5;return window.jQuery&&$.fn.tooltip!=null&&$.fn.tooltip.Constructor!=null&&(e=parseInt($.fn.tooltip.Constructor.VERSION.charAt(0))),e}isSelected(e){let t=Array.from(this.selectElement.querySelectorAll("option")).find(s=>s.textContent==e);return!!(t&&t.getAttribute("selected"))}isDisabled(){return this.selectElement.hasAttribute("disabled")||this.selectElement.hasAttribute("readonly")}validateRegex(e){return new RegExp(this.validationRegex.trim()).test(e)}addItem(e,t=null,s={}){if(t||(t=e),this.validationRegex&&!this.validateRegex(e))return this.holderElement.classList.add("is-invalid"),!1;let r=this.getBootstrapVersion(),i=this.selectElement.querySelector('option[value="'+t+'"]');i&&(s=i.dataset);let l=e,o=document.createElement("span"),d=this.badgeStyle;if(o.classList.add("badge"),s.badgeStyle&&(d=s.badgeStyle),s.badgeClass&&o.classList.add(s.badgeClass),r===5?(o.classList.add("bg-"+d),o.classList.add("me-2")):(o.classList.add("badge-"+d),o.classList.add("mr-2")),o.setAttribute(x,t),this.allowClear&&(l=(r===5?'<button type="button" style="font-size:0.65em" class="me-2 btn-close btn-close-white" aria-label="'+this.clearLabel+'"></button>':'<button type="button" style="font-size:1em;float:left;text-shadow:none;color:currentColor;" class="mr-2 close" aria-label="'+this.clearLabel+'"><span aria-hidden="true">&times;</span></button>')+l),o.innerHTML=l,this.containerElement.insertBefore(o,this.searchInput),this.allowClear&&o.querySelector("button").addEventListener("click",h=>{h.preventDefault(),h.stopPropagation(),this.removeItem(t),document.activeElement.blur()}),i)i.setAttribute("selected","selected");else{i=document.createElement("option"),i.value=t,i.innerText=e;for(let[h,a]of Object.entries(s))i.dataset[h]=a;i.setAttribute("selected","selected"),this.selectElement.appendChild(i)}return!0}removeItem(e){let t=this.containerElement.querySelector("span["+x+'="'+e+'"]');if(!t)return;t.remove();let s=this.selectElement.querySelector('option[value="'+e+'"]');s&&s.removeAttribute("selected"),this.searchInput.style.visibility=="hidden"&&this.max&&this.getSelectedValues().length<this.max&&(this.searchInput.style.visibility="visible")}},Ee=M;var $t=Ee;export{$t as default};
//# sourceMappingURL=tags-standalone.min.js.map
